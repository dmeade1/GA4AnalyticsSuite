<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="GA4 Analytics Platform for RMSMC - Comprehensive analytics dashboard with period comparison capabilities">
  <title>GA4 Analytics Platform | RMSMC</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="custom-button.css">

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client"></script>

  <!-- Google API Client Library -->
  <script src="https://apis.google.com/js/api.js"></script>

  <!-- Chart.js for Data Visualization -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>

<body>
  <!-- Header -->
  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <div class="logo-icon"
            style="background: transparent !important; box-shadow: none !important; border: none !important; width: 48px !important; height: 48px !important; padding: 0 !important;">
            <img src="rmsmc-logo.png" alt="RMSMC Logo"
              style="max-width: 42px; max-height: 42px; width: auto; height: auto;">
          </div>
          <div class="logo-text">
            <h1
              style="color: #0f172a !important; background: none !important; -webkit-text-fill-color: currentColor !important;">
              Analytics Suite</h1>
            <p>RMSMC Performance Dashboard</p>
          </div>
        </div>

        <div class="user-section">
          <!-- Sign In Button (shown when not authenticated) -->
          <div id="signInButton" class="hidden"></div>

          <!-- User Info (shown when authenticated) -->
          <div id="userInfo" class="user-info hidden">
            <img id="userAvatar" class="user-avatar" src="" alt="User Avatar">
            <span id="userName" class="user-name"></span>
          </div>

          <!-- Sign Out Button (shown when authenticated) -->
          <button id="signOutButton" class="btn btn-secondary btn-sm hidden">
            Sign Out
          </button>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main">
    <div class="container">
      <!-- Authentication Required Message -->
      <div id="authRequired" class="card text-center">
        <div class="card-header">
          <h2 class="card-title">üîê Authentication Required</h2>
          <p class="card-subtitle">Sign in with your Google account to access GA4 analytics data</p>
        </div>
        <p class="text-muted mb-lg">
          This platform connects to your Google Analytics 4 properties to provide comprehensive analytics and period
          comparisons.
          You'll need to grant permission to access your GA4 data.
        </p>
        <div id="authButtonContainer"></div>
      </div>

      <!-- Configuration Panel -->
      <div id="configPanel" class="card hidden">
        <div class="card-header">
          <h3 class="card-title">‚öôÔ∏è Configuration</h3>
          <p class="card-subtitle">Configure your GA4 property and date ranges</p>
        </div>

        <div class="grid grid-2">
          <!-- Comparison Mode Selector -->
          <div class="form-group">
            <label class="form-label" for="comparisonMode">Comparison Type</label>
            <select id="comparisonMode" class="form-select" aria-label="Comparison Mode">
              <option value="time">Time Period Comparison</option>
              <option value="property">Property Comparison</option>
            </select>
          </div>

          <!-- GA4 Property Configuration (Time Comparison Mode) -->
          <div class="form-group" id="singlePropertyGroup">
            <label class="form-label" for="propertyId">Select Property</label>
            <select id="propertyId" class="form-select" aria-label="Select GA4 Property">
              <option value="" disabled selected>Choose a property...</option>
              <option value="321341958">Collegian</option>
              <option value="352970688">KCSU</option>
              <option value="352990478">RMSMC</option>
              <option value="397333725">Fifty03'</option>
              <option value="352975714">College Avenue</option>
            </select>
          </div>
        </div>

        <!-- Multi-Property Selection (Property Comparison Mode) -->
        <div id="multiPropertyGroup" class="hidden">
          <div class="form-group">
            <label class="form-label">Select Properties to Compare</label>
            <div class="property-checkboxes">
              <label class="checkbox-label">
                <input type="checkbox" name="properties" value="321341958"> Collegian
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="properties" value="352970688"> KCSU
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="properties" value="352990478"> RMSMC
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="properties" value="397333725"> Fifty03'
              </label>
              <label class="checkbox-label">
                <input type="checkbox" name="properties" value="352975714"> College Avenue
              </label>
            </div>
          </div>
        </div>

        <!-- Date Range Configuration -->
        <div class="grid grid-2">
          <!-- Date Range Preset (shown in Time Comparison Mode) -->
          <div class="form-group" id="dateRangePresetGroup">
            <label class="form-label" for="dateRangePreset">Date Range Comparison</label>
            <select id="dateRangePreset" class="form-select" aria-label="Date Range Preset">
              <option value="7days">Last 7 Days vs Previous 7 Days</option>
              <option value="30days">Last 30 Days vs Previous 30 Days</option>
              <option value="90days">Last 90 Days vs Previous 90 Days</option>
              <option value="month">This Month vs Last Month</option>
              <option value="year">This Year vs Last Year</option>
              <option value="fiscal_year">Fiscal Year (Jun 30 - Jun 30)</option>
              <option value="custom">Custom Date Ranges</option>
            </select>
            <p id="fiscalYearHelper" class="text-xs text-muted mt-xs italic hidden">
              *Fiscal Year runs from June 30 to June 30
            </p>
          </div>

          <!-- Single Date Range (shown in Property Comparison Mode) -->
          <div class="form-group hidden" id="singleDateRangeGroup">
            <label class="form-label" for="singleDateRange">Date Range</label>
            <select id="singleDateRange" class="form-select" aria-label="Single Date Range">
              <option value="7days">Last 7 Days</option>
              <option value="30days">Last 30 Days</option>
              <option value="90days">Last 90 Days</option>
              <option value="month">This Month</option>
              <option value="year">This Year</option>
              <option value="fiscal_year">Fiscal Year (Jun 30 - Jun 30)</option>
              <option value="custom">Custom Range</option>
            </select>
            <p id="fiscalYearHelperSingle" class="text-xs text-muted mt-xs italic hidden">
              *Fiscal Year runs from June 30 to June 30
            </p>
          </div>
        </div>

        <!-- Custom Date Ranges -->
        <div id="customDateRanges" class="hidden">
          <!-- Time Comparison: Two date ranges -->
          <div id="customTimeRanges" class="grid grid-2">
            <div class="form-group">
              <label class="form-label" for="startDate1">Primary Period Start</label>
              <input type="date" id="startDate1" class="form-input" aria-label="Primary Period Start Date">
            </div>
            <div class="form-group">
              <label class="form-label" for="endDate1">Primary Period End</label>
              <input type="date" id="endDate1" class="form-input" aria-label="Primary Period End Date">
            </div>
            <div class="form-group">
              <label class="form-label" for="startDate2">Comparison Period Start</label>
              <input type="date" id="startDate2" class="form-input" aria-label="Comparison Period Start Date">
            </div>
            <div class="form-group">
              <label class="form-label" for="endDate2">Comparison Period End</label>
              <input type="date" id="endDate2" class="form-input" aria-label="Comparison Period End Date">
            </div>
          </div>

          <!-- Property Comparison: Single date range -->
          <div id="customPropertyRanges" class="grid grid-2 hidden">
            <div class="form-group">
              <label class="form-label" for="startDateSingle">Start Date</label>
              <input type="date" id="startDateSingle" class="form-input" aria-label="Start Date">
            </div>
            <div class="form-group">
              <label class="form-label" for="endDateSingle">End Date</label>
              <input type="date" id="endDateSingle" class="form-input" aria-label="End Date">
            </div>
          </div>
        </div>

        <!-- Content Filters -->
        <div class="card-section mt-lg">
          <h4 class="text-sm font-semibold mb-sm">Content Filters</h4>
          <div class="form-group">
            <label class="checkbox-label">
              <input type="checkbox" id="enableExcludeFilter"> Exclude Page Path
            </label>
            <div id="excludeFilterInputGroup" class="mt-sm hidden">
              <label class="form-label text-xs" for="excludePagePath">Exclude paths containing:</label>
              <input type="text" id="excludePagePath" class="form-input" placeholder="/sponsored/" value="/sponsored/">
            </div>
          </div>
        </div>

        <div class="flex" style="justify-content: flex-end; margin-top: var(--spacing-lg);">
          <button id="fetchDataButton" class="btn btn-primary btn-lg">
            üìä Fetch Analytics Data
          </button>
        </div>

        <!-- Error/Success Messages -->
        <div id="configMessage" class="hidden mt-lg"></div>
      </div>

      <!-- Dashboard -->
      <div id="dashboard" class="hidden" style="margin-top: 3rem;">
        <!-- Metrics Grid -->
        <!-- Metrics Grid -->
        <div class="grid grid-4 mb-xl">
          <!-- 1. Page Views -->
          <div class="metric-card fade-in">
            <div class="metric-header">
              <span class="metric-label">Page Views</span>
              <div class="metric-icon">üìÑ</div>
            </div>
            <div class="metric-value" id="metricPageViews">-</div>
            <div class="metric-comparison">
              <span id="comparisonPageViews" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValuePageViews">-</span>
            </div>
          </div>

          <!-- 2. Avg Monthly Page Views -->
          <div class="metric-card fade-in" style="animation-delay: 0.05s;">
            <div class="metric-header">
              <span class="metric-label">Avg Monthly Views</span>
              <div class="metric-icon">üìÖ</div>
            </div>
            <div class="metric-value" id="metricAvgMonthlyViews">-</div>
            <div class="metric-comparison">
              <span id="comparisonAvgMonthlyViews" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueAvgMonthlyViews">-</span>
            </div>
          </div>

          <!-- 3. Mobile Page Views -->
          <div class="metric-card fade-in" style="animation-delay: 0.1s;">
            <div class="metric-header">
              <span class="metric-label">Mobile Page Views</span>
              <div class="metric-icon">üì±</div>
            </div>
            <div class="metric-value" id="metricMobileViews">-</div>
            <div class="metric-comparison">
              <span id="comparisonMobileViews" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueMobileViews">-</span>
            </div>
          </div>

          <!-- 4. Unique Visitors -->
          <div class="metric-card fade-in" style="animation-delay: 0.2s;">
            <div class="metric-header">
              <span class="metric-label">Unique Visitors</span>
              <div class="metric-icon">üë•</div>
            </div>
            <div class="metric-value" id="metricUsers">-</div>
            <div class="metric-comparison">
              <span id="comparisonUsers" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueUsers">-</span>
            </div>
          </div>

          <!-- 5. Sessions -->
          <div class="metric-card fade-in" style="animation-delay: 0.3s;">
            <div class="metric-header">
              <span class="metric-label">Sessions</span>
              <div class="metric-icon">üîÑ</div>
            </div>
            <div class="metric-value" id="metricSessions">-</div>
            <div class="metric-comparison">
              <span id="comparisonSessions" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueSessions">-</span>
            </div>
          </div>

          <!-- 6. Avg Events Per Session -->
          <div class="metric-card fade-in" style="animation-delay: 0.4s;">
            <div class="metric-header">
              <span class="metric-label">Avg Events / Session</span>
              <div class="metric-icon">üìë</div>
            </div>
            <div class="metric-value" id="metricPagesPerSession">-</div>
            <div class="metric-comparison">
              <span id="comparisonPagesPerSession" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValuePagesPerSession">-</span>
            </div>
          </div>

          <!-- 7. Avg Time on Site -->
          <div class="metric-card fade-in" style="animation-delay: 0.5s;">
            <div class="metric-header">
              <span class="metric-label">Avg Time on Site</span>
              <div class="metric-icon">‚è±Ô∏è</div>
            </div>
            <div class="metric-value" id="metricAvgTime">-</div>
            <div class="metric-comparison">
              <span id="comparisonAvgTime" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueAvgTime">-</span>
            </div>
          </div>

          <!-- 8. % Traffic from Social Media -->
          <div class="metric-card fade-in" style="animation-delay: 0.6s;">
            <div class="metric-header">
              <span class="metric-label">% Social Traffic</span>
              <div class="metric-icon">üí¨</div>
            </div>
            <div class="metric-value" id="metricSocialTraffic">-</div>
            <div class="metric-comparison">
              <span id="comparisonSocialTraffic" class="metric-change neutral">-</span>
              <span class="text-muted">vs previous</span>
            </div>
            <div class="text-xs text-muted" style="margin-top: 0.25rem;">
              Previous: <span id="comparisonValueSocialTraffic">-</span>
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="grid grid-2">
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">üìà Trend Analysis</h3>
              <p class="card-subtitle">Daily comparison of key metrics</p>
            </div>
            <div class="chart-container">
              <canvas id="trendChart"></canvas>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <h3 class="card-title">üìä Period Comparison</h3>
              <p class="card-subtitle">Side-by-side metric comparison</p>
            </div>
            <div class="chart-container">
              <canvas id="comparisonChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Detailed Data Table -->
        <div class="card mt-xl">
          <div class="card-header">
            <h3 class="card-title">üìã Detailed Metrics</h3>
            <p class="card-subtitle">Complete breakdown of analytics data</p>
          </div>
          <div id="dataTable" style="overflow-x: auto;"></div>
        </div>
      </div>

      <!-- Loading State -->
      <div id="loadingState" class="hidden">
        <div class="card text-center">
          <div class="loading">
            <div class="spinner"></div>
          </div>
          <p class="text-muted">Fetching analytics data from GA4...</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Configuration -->
  <script src="config.js"></script>

  <!-- Application Script -->
  <script src="app.js"></script>
</body>

</html>